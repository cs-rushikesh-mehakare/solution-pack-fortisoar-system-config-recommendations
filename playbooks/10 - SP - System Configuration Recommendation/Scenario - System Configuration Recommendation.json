{
    "@context": "\/api\/3\/contexts\/Workflow",
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "Scenario - System Configuration Recommendation",
    "aliasName": null,
    "tag": null,
    "description": "This playbook is triggered by Scenario record to generate configuration recommendation report",
    "isActive": true,
    "debug": true,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [],
    "synchronous": false,
    "collection": "\/api\/3\/workflow_collections\/dbf8de0d-974b-451d-bbbc-8d4e2ec77ec4",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/74a7dcd0-6482-4ab9-a33f-6598255a3e32",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Attach Attachment to Task",
            "description": null,
            "arguments": {
                "resource": {
                    "__link": {
                        "attachments": "{{vars.steps.Report_as_Attachment.data['@id']}}"
                    },
                    "status": "\/api\/3\/picklists\/343f4b67-e929-4205-bf95-ba5b70545fed"
                },
                "operation": "Append",
                "collection": "{{vars.steps.Create_Task_For_Tracking_Purposes['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/tasks",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "380",
            "left": "1700",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "72479bb8-d469-4943-871a-fb9f8d033f1a"
        },
        {
            "@type": "WorkflowStep",
            "name": "Check For Error In Output",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "is not present",
                        "step_iri": "\/api\/3\/workflow_steps\/ea015a19-e46e-47db-8f4b-0745e085ac6e",
                        "condition": "{{ (vars.system_config[\"error\"] is undefined) or (vars.system_config[\"error\"] == None) }}",
                        "step_name": "Get Input Confirmation"
                    },
                    {
                        "option": "is present",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/d958bb42-c270-4201-b1aa-8d3b0084973a",
                        "step_name": "No Oprations"
                    }
                ],
                "step_variables": []
            },
            "status": null,
            "top": "80",
            "left": "20",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": "\/api\/3\/workflow_groups\/d65f78fb-e9ae-410c-a966-28a280bc3fde",
            "uuid": "d2445dec-59c0-49db-becf-8ea878ae524f"
        },
        {
            "@type": "WorkflowStep",
            "name": "Create Report File",
            "description": null,
            "arguments": {
                "params": {
                    "contents": "{{vars.HTML}}",
                    "filename": "Recommended_System_Configuration_{{arrow.utcnow().int_timestamp}}.html",
                    "mimetype": ""
                },
                "version": "3.2.6",
                "connector": "cyops_utilities",
                "operation": "create_file_from_string",
                "operationTitle": "File: Create File from String",
                "step_variables": []
            },
            "status": null,
            "top": "60",
            "left": "380",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "group": "\/api\/3\/workflow_groups\/3d297f34-8c58-43ac-bc66-4de66a9d68ff",
            "uuid": "5a614d4a-7de5-41ba-9a92-349d38b46f3b"
        },
        {
            "@type": "WorkflowStep",
            "name": "Create Task For Tracking Purposes",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "",
                    "thread": false,
                    "content": "<p>Analyzing Your System for following details&nbsp;<\/p>\n<ol>\n<li>CPU<\/li>\n<li>RAM<\/li>\n<li>IOPS<\/li>\n<li>Disk Latency&nbsp;<\/li>\n<li>SHMALL<\/li>\n<li>SHMMAX<\/li>\n<\/ol>",
                    "records": "{{vars.steps.Create_Task_For_Tracking_Purposes['@id']}}"
                },
                "resource": {
                    "name": "System Configuration Recommendation",
                    "type": "\/api\/3\/picklists\/6d113f01-123a-4c78-b68c-029e16df9b8b",
                    "status": "\/api\/3\/picklists\/7669725a-28cc-4b19-98a3-9ca71e0f88f4",
                    "priority": "\/api\/3\/picklists\/ebe64b35-bf47-4f74-aadb-df7c2aeba60e",
                    "__replace": "",
                    "recordTags": [
                        "\/api\/3\/tags\/System Configuration Recommendation"
                    ],
                    "description": "### This Task is Create for Tracking of System Configuration Recommendation Playbook\n\n\n* * *\n\n#### For HA setup Only \n\nMake sure that all the Nodes have Same Configuration in their configuration files.  And while restarting services, start with Primary node and then same for Secondary Nodes",
                    "assignedToPerson": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce"
                },
                "operation": "Overwrite",
                "collection": "\/api\/3\/tasks",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "120",
            "left": "360",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "d90d974a-7ecb-4ace-925b-a20dc3c30122"
        },
        {
            "@type": "WorkflowStep",
            "name": "Error Found While Analyzing System",
            "description": null,
            "arguments": {
                "params": [],
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "",
                    "thread": false,
                    "content": "<h4><span style=\"color: rgb(224, 62, 45);\">Error : {% if (vars.system_config[\"error\"]| regex_search(\"PGSQL\") and (vars.system_config[\"error\"]| regex_search(\"PGSQL\")).strip())%}Please mount a drive for PGSQL directory{% elif (vars.system_config[\"error\"]| regex_search(\"command failed\") and (vars.system_config[\"error\"]| regex_search(\"command failed\")).strip())%}Command Failed{% elif (vars.system_config[\"error\"]| regex_search(\"following commands are installed or not\") and (vars.system_config[\"error\"]| regex_search(\"following commands are installed or not\")).strip())%}Make sure that all commands required are installed{% else%}{{vars}}{% endif %}<\/span><\/h4>\n<hr>\n<p>&nbsp;{{vars.system_config[\"error\"]}}<br>{{vars.system_config[\"error_log\"] if vars.system_config[\"error_log\"] is defined}}<\/p>",
                    "records": "{{vars.steps.Create_Task_For_Tracking_Purposes['@id']}}",
                    "parentstepid": "\/api\/3\/workflow_steps\/undefined"
                },
                "version": "3.2.6",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
            },
            "status": null,
            "top": "80",
            "left": "360",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "group": "\/api\/3\/workflow_groups\/d65f78fb-e9ae-410c-a966-28a280bc3fde",
            "uuid": "d958bb42-c270-4201-b1aa-8d3b0084973a"
        },
        {
            "@type": "WorkflowStep",
            "name": "Generate Report Code",
            "description": null,
            "arguments": {
                "HTML": "<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <title>FortiSOAR<\/title>\n    <style>\n        table.GeneratedTable {\n            width: 100%;\n            background-color: #797777;\n            border-collapse: collapse;\n            border-width: 2px;\n            border-color: #080808;\n            border-style: solid;\n            color: #f3f2f2;\n        }\n\n        table.GeneratedTable td,\n        table.GeneratedTable th {\n            border-width: 2px;\n            border-color: #080808;\n            border-style: solid;\n            padding: 3px;\n        }\n\n        table.GeneratedTable thead {\n            background-color: #5074e2;\n        }\n        .spacing-div{\n            height: 2vw;\n        }\n        code{\n            color: crimson;\n            background-color: #f1f1f1;\n            padding: 2px;\n            font-size: 105%;\n        }\n        \n    <\/style>\n<\/head>\n\n<body>\n    <h1>\n        <center>FortiSOAR - Recommended System Configuration.<\/center>\n    <\/h1>\n    <div class=\"spacing-div\"><\/div>\n    <!-- <p> We performed a scan of system for resources like CPU , RAM , Disk\n        Here are details about it\n    <p> -->\n    <h2> Here are your System Details<\/h2>\n    <table class=\"GeneratedTable\">\n        <thead>\n            <tr>\n                <th>Sr No<\/th>\n                <th>System Entity<\/th>\n                <th>Value<\/th>\n            <\/tr>\n        <\/thead>\n        <tbody>\n            <tr>\n                <td>1<\/td>\n                <td>CPU<\/td>\n                <td>{{vars.system_config.CPU}}\n                <\/td>\n            <\/tr>\n            <tr>\n                <td>2<\/td>\n                <td>RAM\n                <\/td>\n                <td>{{vars.system_config.RAM}} GB\n                <\/td>\n            <\/tr>\n            <tr>\n                <td>3<\/td>\n                <td>Disk Latency\n                <\/td>\n                <td>{{vars.system_config[\"Disk latency\"]}}\n                <\/td>\n            <\/tr>\n            <tr>\n                <td>3<\/td>\n                <td>Disk IOPS - Read\n                <\/td>\n                <td>{{vars.system_config[\"Disk IOPS - Read\"]}}\n                <\/td>\n            <\/tr>\n            <tr>\n                <td>4<\/td>\n                <td>Disk IOPS - Write\n                <\/td>\n                <td>{{vars.system_config[\"Disk IOPS - Write\"]}}\n            <\/tr>\n            <tr>\n                <td>5<\/td>\n                <td>SHMALL\n                <\/td>\n                <td>{{vars.system_config[\"SHMALL\"]}}\n            <\/tr>\n            <tr>\n                <td>6<\/td>\n                <td>SHMMAX\n                <\/td>\n                <td>{{vars.system_config[\"SHMMAX\"]}}\n            <\/tr>\n        <\/tbody>\n    <\/table>\n\n    <div class=\"spacing-div\"><\/div>\n    <h2>We recommend following system configuration based on system information gathered <\/h2>\n    <h2>Recommendation for Celery-D, Sealab_WSGI, RabbitMQ, Integrations_WSGI and NGINX<\/h2>\n    <table class=\"GeneratedTable\">\n        <thead>\n            <tr>\n                <th>Sr No<\/th>\n                <th>Configuration File<\/th>\n                <th>Recommendation<\/th>\n            <\/tr>\n        <\/thead>\n        <tbody>\n            <tr>\n                <td>1<\/td>\n                <td>File -\/etc\/celery\/celeryd.conf<\/td>\n                <td>Update key CELERYD_OPTS to use value = \"--concurrency={{vars.system_config.CPU}}\"\n                <\/td>\n            <\/tr>\n            <tr>\n                <td>2<\/td>\n                <td>File - \/etc\/uwsgi.d\/sealab_wsgi.ini\n                <\/td>\n                <td>Update value of processes to {{vars.system_config.CPU}} , e.g processes = {{vars.system_config.CPU}}\n                <\/td>\n            <\/tr>\n            <tr>\n                <td>3<\/td>\n                <td>File - \/etc\/uwsgi.d\/integrations_wsgi.ini\n                <\/td>\n                <td>Update value of processes to {{vars.system_config.CPU}} , e.g processes = {{vars.system_config.CPU}}\n                <\/td>\n            <\/tr>\n            <tr>\n                <td>4<\/td>\n                <td>File - \/etc\/nginx\/nginx.conf\n                <\/td>\n                <td>Set value of worker processes as auto - e.g worker_processes auto\n                <\/td>\n            <\/tr>\n            {{\"<tr>\n                <td>5<\/td>\n                <td>File - \/etc\/rabbitmq\/rabbitmq-env.conf\n                <\/td>\n                <td>Update the Value of RABBITMQ_SERVER_ADDITIONAL_ERL_ARGS to \\\"+S 8:8\\\"\n                <\/td>\n            <\/tr>\" if (vars.system_config.CPU |int)  >= 16 }}\n        <\/tbody>\n    <\/table>\n\n    <div class=\"spacing-div\"><\/div>\n    <h2>Recommendation for PostgreSQL<\/h2>\n    <table class=\"GeneratedTable\">\n        <thead>\n            <tr>\n                <th>Sr No<\/th>\n                <th>Property<\/th>\n                <th>Recommended Value<\/th>\n                <th>Unit<\/th>\n            <\/tr>\n        <\/thead>\n        <tbody>\n            <tr>\n                <td>1<\/td>\n                <td>shared_buffer{% set variable = (vars.sharedBuffersValue | int) %}<\/td>\n                <td>{{((variable\/1024) if variable > 4096 else (variable))| round | int}}<\/td>\n                <td>{{'GB' if variable > 4096 else 'MB' }}<\/td>\n            <\/tr>\n            <tr>\n                <td>2<\/td>\n                <td>work_mem{% set variable = (vars.workMem | int) %}<\/td>\n                <td>{{((variable\/1024) if variable > 4096 else (variable))| round | int}}<\/td>\n                <td>{{'GB' if variable > 4096 else 'MB' }}<\/td>\n            <\/tr>\n            <tr>\n                <td>3<\/td>\n                <td>wal_buffers{% set variable = (vars.walBuffers | int) %}<\/td>\n                <td>{{((variable\/1024) if variable > 4096 else (variable))| round | int}}<\/td>\n                <td>{{'GB' if variable > 4096 else 'MB' }}<\/td>\n            <\/tr>\n            <tr>\n                <td>4<\/td>\n                <td>effective_cache_size{% set variable = (vars.effectiveCacheSize | int) %}<\/td>\n                <td>{{((variable\/1024) if variable > 4096 else (variable))| round | int}}<\/td>\n                <td>{{'GB' if variable > 4096 else 'MB' }}<\/td>\n            <\/tr>\n            <tr>\n                <td>5<\/td>\n                <td>maintenance_work_mem{% set variable = (vars.maintenanceWorkMem | int) %}<\/td>\n                <td>{{((variable\/1024) if variable > 4096 else (variable))| round | int}}<\/td>\n                <td>{{'GB' if variable > 4096 else 'MB' }}<\/td>\n            <\/tr>\n            <tr>\n                <td>6<\/td>\n                <td>max_wal_size{% set variable = (vars.max_wal_size | int) %}<\/td>\n                <td>{{((variable\/1024) if variable > 4096 else (variable))| round | int}}<\/td>\n                <td>{{'GB' if variable > 4096 else 'MB' }}<\/td>\n            <\/tr>\n            <tr>\n                <td>7<\/td>\n                <td>min_wal_size{% set variable = (vars.min_wal_size | int) %}<\/td>\n                <td>{{((variable\/1024) if variable > 4096 else (variable))| round | int}}<\/td>\n                <td>{{'GB' if variable > 4096 else 'MB' }}<\/td>\n            <\/tr>\n            <tr>\n                <td>8<\/td>\n                <td>random_page_cost<span style=\"color: red;\">*<\/span><\/td>\n                <td>{{vars.randomPageCost_SSD}}<\/td>\n                <td> <\/td>\n            <\/tr>\n            <tr>\n                <td>9<\/td>\n                <td>max_parallel_workers<\/td>\n                <td>{{vars.max_parallel_workers}}<\/td>\n                <td> <\/td>\n            <\/tr>\n            <tr>\n                <td>10<\/td>\n                <td>max_worker_processes<\/td>\n                <td>{{vars.max_worker_processes}}<\/td>\n                <td> <\/td>\n            <\/tr>\n            <tr>\n                <td>11<\/td>\n                <td>checkpoint_completion_target<\/td>\n                <td>{{vars.checkpointCompletionTarget}}<\/td>\n                <td> <\/td>\n            <\/tr>\n            <tr>\n                <td>12<\/td>\n                <td>effective_io_concurrency<span style=\"color: red;\">*<\/span><\/td>\n                <td>{{vars.effectiveIoConcurrency_SSD}}<\/td>\n                <td> <\/td>\n            <\/tr>\n            <tr>\n                <td>13<\/td>\n                <td>max_parallel_workers_per_gather<\/td>\n                <td>{{vars.max_parallel_workers_per_gather}}<\/td>\n                <td> <\/td>\n            <\/tr>\n            <tr>\n                <td>14<\/td>\n                <td>max_parallel_maintaince_worker<\/td>\n                <td>{{vars.max_parallel_workers_per_gather}}<\/td>\n                <td><\/td>\n            <\/tr>\n            <tr>\n                <td>15<\/td>\n                <td>max_connections<\/td>\n                <td>{{vars.max_connections}}<\/td>\n                <td><\/td>\n            <\/tr>\n        <\/tbody>\n    <\/table>\n\n    <p> <span style=\"color: red;\">*<\/span> <span style=\"font-style: italic;font-weight: bold;text-decoration: underline;\"> Note : These field is applicable only when your system's storage is Solid State Drive <\/span> <\/p>\n\n    <div>\n        <h2>Here is the way to use this configuration and apply in you VM <\/h2>\n        <h3>Steps to incorporate the above listed recommendation<\/h3>\n        <ol>\n            <li>Login to Terminal of Your VM via SSH<\/li>\n            <li>Edit following files with above mentioned changes <br\/>\n                <ul>\n                    <li>\n                        Celery-D<br\/>\n                        <ul>\n                            <li>File Location :  <code>\/etc\/celery\/celeryd.conf<\/code><\/li>\n                        <\/ul>\n                    <\/li>\n                    <li>\n                        Sealab_WSGI<br\/>\n                        <ul>\n                            <li>File Location :  <code>\/etc\/uwsgi.d\/sealab_wsgi.ini<\/code><\/li>\n                        <\/ul>\n                    <\/li>\n                    <li>\n                        Integrations_WSGI<br\/>\n                        <ul>\n                            <li>File Location :  <code>\/etc\/uwsgi.d\/integrations_wsgi.ini<\/code><\/li>\n                        <\/ul>\n                    <\/li>\n                    {{\"<li>\n                        RabbitMQ<br\/>\n                        <ul>\n                            <li>File Location :  <code>\/etc\/rabbitmq\/rabbitmq-env.conf<\/code><\/li>\n                        <\/ul>\n                        <\/li>\" if (vars.system_config.CPU |int)  >= 16 }}\n                    <li>\n                        NGINX<br\/>\n                        <ul>\n                            <li>File Location : <code>\/etc\/nginx\/nginx.conf<\/code><\/li> \n                        <\/ul>\n                    <\/li>\n                    <li>\n                        PostgreSQL<br\/>\n                        <ul>\n                            <li>File Location :  <code>\/var\/lib\/pgsql\/14\/data\/postgresql.conf<\/code><\/li>\n                        <\/ul>\n                    <\/li>\n                <\/ul>\n            <\/li>\n            <li>Restart services using csadm commands <code>csadm services --restart<\/code><\/li>\n        <\/ol>\n    <\/div>\n    \n<\/body>\n\n<\/html>",
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "thread": false,
                    "content": "<p>System Details are Analysed and Creating Report<\/p>",
                    "records": "{{vars.steps.Create_Task_For_Tracking_Purposes['@id']}}",
                    "parentstepid": "\/api\/3\/workflow_steps\/f369a0d1-880a-4dfb-a947-17ff10356b8c"
                }
            },
            "status": null,
            "top": "60",
            "left": "60",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/3d297f34-8c58-43ac-bc66-4de66a9d68ff",
            "uuid": "4762ed22-ef55-45e0-bc73-665c18942eb0"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get Input Confirmation",
            "description": null,
            "arguments": {
                "type": "InputBased",
                "input": {
                    "schema": {
                        "title": "Confirm System Configuration",
                        "description": "We have capture system configuration. Please confirm to proceed.\nYou can reduce  CPU & RAM number so that suggestion will not use all of CPU \/ RAM  or proceed to use complete CPU \/ RAM for system tune up.\n\n1. CPU - {{vars.system_config.CPU}}\n2. RAM - {{vars.system_config.RAM}}\n3. Disk IOPS - Read - {{vars.system_config[\"Disk IOPS - Read\"]}}\n4. Disk IOPS - Write - {{vars.system_config[\"Disk IOPS - Write\"]}}\n5. Disk latency - {{vars.system_config[\"Disk latency\"]}}\n6. SHMMAX - {{vars.system_config[\"SHMMAX\"]}}\n7. SHMALL - {{vars.system_config[\"SHMALL\"]}}",
                        "inputVariables": []
                    }
                },
                "record": "{{vars.steps.Create_Task_For_Tracking_Purposes['@id']}}",
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "",
                    "thread": false,
                    "content": "<p>Waiting for Your approval, To confirm that below system configuration is correct&nbsp;<\/p>\n<p>1. CPU - {{vars.system_config.CPU}}<br>2. RAM - {{vars.system_config.RAM}}<br>3. Disk IOPS - Read - {{vars.system_config[\"Disk IOPS - Read\"]}}<br>4. Disk IOPS - Write - {{vars.system_config[\"Disk IOPS - Write\"]}}<br>5. Disk latency - {{vars.system_config[\"Disk latency\"]}}<br>6. SHMMAX - {{vars.system_config[\"SHMMAX\"]}}<br>7. SHMALL - {{vars.system_config[\"SHMALL\"]}}<\/p>",
                    "records": "{{vars.steps.Create_Task_For_Tracking_Purposes['@id']}}",
                    "parentstepid": "\/api\/3\/workflow_steps\/bd5e75ed-95e1-4b30-8682-5c9e68824c9a"
                },
                "agent_id": null,
                "resources": "tasks",
                "is_approval": false,
                "owner_detail": {
                    "isAssigned": false,
                    "emailRecipients": ""
                },
                "isRecordLinked": true,
                "step_variables": {
                    "RAM": "{{(vars.system_config.RAM | int) - 10}}",
                    "sharedBuffersValue": "{{(((vars.system_config.RAM | int - 10)\/ 4 ) * 1024 ) | round}}"
                },
                "response_mapping": {
                    "options": [
                        {
                            "option": "Details Are Correct",
                            "primary": true,
                            "step_iri": "\/api\/3\/workflow_steps\/906fd8bb-8c4f-41f1-8957-f0af85e63a1c"
                        },
                        {
                            "option": "Review Required",
                            "step_iri": "\/api\/3\/workflow_steps\/925b3363-9514-481b-a6f2-ca6b2c978c89"
                        }
                    ],
                    "duplicateOption": false,
                    "customSuccessMessage": "Awaiting Playbook resumed successfully."
                },
                "email_notification": {
                    "enabled": false,
                    "smtpParameters": []
                },
                "customEmailExternal": false,
                "inline_channel_list": [],
                "external_channel_list": [],
                "unauthenticated_input": false,
                "external_email_subject": null,
                "internal_email_subject": "A FortiSOAR playbook is requesting your input",
                "custom_email_body_external": null,
                "external_email_attachments": null
            },
            "status": null,
            "top": "60",
            "left": "20",
            "stepType": "\/api\/3\/workflow_step_types\/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
            "group": "\/api\/3\/workflow_groups\/d045e020-f8a5-4753-878a-2c10a4127511",
            "uuid": "ea015a19-e46e-47db-8f4b-0745e085ac6e"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get System Configuration",
            "description": null,
            "arguments": {
                "name": "SSH",
                "config": "739b5a4e-30ca-4c76-a1d7-0ee9d694cff4",
                "params": {
                    "cmd": "\/bin\/python3  \/opt\/cyops\/scripts\/get-system-details.py",
                    "allowed_exit": "-1,0",
                    "is_super_user": false
                },
                "version": "2.1.2",
                "connector": "ssh",
                "operation": "run_remote_command",
                "mock_result": "{\n\"data\":{'CPU': '32', 'RAM': '64', 'Disk IOPS - Read': '22k', 'Disk IOPS - Write': '22k', 'Disk latency': ' 820.0 us ', 'SHMALL': '2017224', 'SHMMAX': '8262549504'}\n}",
                "operationTitle": "Execute remote command",
                "pickFromTenant": false,
                "step_variables": {
                    "system_config": "{{vars.steps.Get_System_Configuration.data | toDict}}"
                }
            },
            "status": null,
            "top": "80",
            "left": "40",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": "\/api\/3\/workflow_groups\/0877769d-2981-40f7-9a8e-4c477f0ee18f",
            "uuid": "f369a0d1-880a-4dfb-a947-17ff10356b8c"
        },
        {
            "@type": "WorkflowStep",
            "name": "Postgresql Configuration",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "thread": false,
                    "content": "<p>Analyzed System Details are validated By user. Proceeding Further<\/p>",
                    "records": "{{vars.steps.Create_Task_For_Tracking_Purposes['@id']}}",
                    "parentstepid": "\/api\/3\/workflow_steps\/f369a0d1-880a-4dfb-a947-17ff10356b8c"
                },
                "workMem": "{% set workMem=(((vars.RAM *1024)-vars.sharedBuffersValue)\/(300 * 3)\/(vars.system_config.CPU  | int \/ 2) | round )%}\n{{workMem | round if workMem>8 else 8}}",
                "walBuffers": "{{((3 * vars.sharedBuffersValue | int ) \/ 100) | round }}",
                "max_wal_size": "4096",
                "min_wal_size": "1024",
                "max_connections": "300",
                "workersPerGather": "4",
                "effectiveCacheSize": "{{((vars.RAM)* 3  * 1024 \/ 4 ) | round}}",
                "maintenanceWorkMem": "{{ ((vars.RAM)* 1024 \/ 16) | round }}",
                "randomPageCost_HDD": "4",
                "randomPageCost_SSD": "1.1",
                "max_parallel_workers": "{{vars.system_config.CPU}}",
                "max_worker_processes": "{{vars.system_config.CPU}}",
                "checkpointCompletionTarget": "0.9",
                "effectiveIoConcurrency_HDD": "2",
                "effectiveIoConcurrency_SSD": "200",
                "parallelMaintenanceWorkers": "4",
                "max_parallel_workers_per_gather": "{{(vars.system_config.CPU  | int \/ 4) | round}}"
            },
            "status": null,
            "top": "400",
            "left": "1000",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "906fd8bb-8c4f-41f1-8957-f0af85e63a1c"
        },
        {
            "@type": "WorkflowStep",
            "name": "Record IRI for Reset",
            "description": null,
            "arguments": {
                "recordIRI": "{{vars.steps.Create_Task_For_Tracking_Purposes}}"
            },
            "status": null,
            "top": "200",
            "left": "1700",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "041c1cb1-4cc5-490b-897d-841e1710771e"
        },
        {
            "@type": "WorkflowStep",
            "name": "Report as Attachment",
            "description": null,
            "arguments": {
                "params": {
                    "name": "{{vars.steps.Create_Report_File.data.filename| regex_replace(\"_[0-9]+[\\.]html\", \"\")}}",
                    "filename": "{{vars.steps.Create_Report_File.data.filename}}",
                    "description": "This is Playbook Generated Report for System Configuration Recommendation",
                    "request_headers": "",
                    "multipart_headers": "",
                    "extra_multipart_fields": ""
                },
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "",
                    "thread": false,
                    "content": "<p>Report Generated&nbsp; and Created Attachment for same.<br><br>Please click on following link to navigate to Attachments {% set uuid=vars.steps.Report_as_Attachment.data[\"@id\"]| regex_search(\"[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}\") %}<a href=\"\/modules\/view-panel\/attachments\/{{uuid}}\">{{vars.steps.Create_Report_File.data.filename| regex_replace(\"_[0-9]+[\\.]html\", \"\")}}<\/a><\/p>\n<p>&nbsp;<\/p>",
                    "records": "{{vars.steps.Create_Task_For_Tracking_Purposes['@id']}}",
                    "parentstepid": "\/api\/3\/workflow_steps\/f369a0d1-880a-4dfb-a947-17ff10356b8c"
                },
                "version": "3.2.6",
                "connector": "cyops_utilities",
                "operation": "create_cyops_attachment",
                "operationTitle": "File: Create Attachment from File",
                "step_variables": []
            },
            "status": null,
            "top": "60",
            "left": "700",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "group": "\/api\/3\/workflow_groups\/3d297f34-8c58-43ac-bc66-4de66a9d68ff",
            "uuid": "c6dcbe63-ddb1-4792-81f1-be31f0d3105b"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "__triggerLimit": true,
                "step_variables": {
                    "input": {
                        "params": []
                    }
                },
                "triggerOnSource": true,
                "triggerOnReplicate": false
            },
            "status": null,
            "top": "120",
            "left": "60",
            "stepType": "\/api\/3\/workflow_step_types\/b348f017-9a94-471f-87f8-ce88b6a7ad62",
            "group": null,
            "uuid": "74a7dcd0-6482-4ab9-a33f-6598255a3e32"
        },
        {
            "@type": "WorkflowStep",
            "name": "User Rejected the Configuration",
            "description": null,
            "arguments": {
                "params": [],
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "",
                    "thread": false,
                    "content": "<p>User has rejected the Analyzed System Details. Please Verify or Update the System Details and Retrigger the Playbook<\/p>",
                    "records": "{{vars.steps.Create_Task_For_Tracking_Purposes['@id']}}",
                    "parentstepid": "\/api\/3\/workflow_steps\/ea015a19-e46e-47db-8f4b-0745e085ac6e"
                },
                "version": "3.2.6",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
            },
            "status": null,
            "top": "60",
            "left": "360",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "group": "\/api\/3\/workflow_groups\/d045e020-f8a5-4753-878a-2c10a4127511",
            "uuid": "925b3363-9514-481b-a6f2-ca6b2c978c89"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Attach Attachment to Task -> Record IRI for Reset",
            "targetStep": "\/api\/3\/workflow_steps\/041c1cb1-4cc5-490b-897d-841e1710771e",
            "sourceStep": "\/api\/3\/workflow_steps\/72479bb8-d469-4943-871a-fb9f8d033f1a",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "fb424753-1fe9-4855-8bb5-26a07409164f"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check For Error In Output -> No Oprations",
            "targetStep": "\/api\/3\/workflow_steps\/d958bb42-c270-4201-b1aa-8d3b0084973a",
            "sourceStep": "\/api\/3\/workflow_steps\/d2445dec-59c0-49db-becf-8ea878ae524f",
            "label": "is present",
            "isExecuted": false,
            "group": null,
            "uuid": "5fd4dec0-f44f-4b75-bc7b-882b1955fbd3"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check if Data is Present -> Get Input Confirmation",
            "targetStep": "\/api\/3\/workflow_steps\/ea015a19-e46e-47db-8f4b-0745e085ac6e",
            "sourceStep": "\/api\/3\/workflow_steps\/d2445dec-59c0-49db-becf-8ea878ae524f",
            "label": "is not present",
            "isExecuted": false,
            "group": null,
            "uuid": "b5c657a3-8e3d-4ab7-85b8-8476214b4451"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create Report File -> Report as Attachment",
            "targetStep": "\/api\/3\/workflow_steps\/c6dcbe63-ddb1-4792-81f1-be31f0d3105b",
            "sourceStep": "\/api\/3\/workflow_steps\/5a614d4a-7de5-41ba-9a92-349d38b46f3b",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "3b8a0a3a-90cd-40a3-8b86-1d9f2aba3829"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create Task For Tracking Purposes1 -> Get System Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/f369a0d1-880a-4dfb-a947-17ff10356b8c",
            "sourceStep": "\/api\/3\/workflow_steps\/d90d974a-7ecb-4ace-925b-a20dc3c30122",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "485d6812-0257-42ba-a2cd-b419ead9fe56"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Error Found While Analyzing System -> Record IRI for Reset",
            "targetStep": "\/api\/3\/workflow_steps\/041c1cb1-4cc5-490b-897d-841e1710771e",
            "sourceStep": "\/api\/3\/workflow_steps\/d958bb42-c270-4201-b1aa-8d3b0084973a",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "0227c5ce-b161-4741-b1fc-cc96ca917732"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Generate Report Code -> Create Report File",
            "targetStep": "\/api\/3\/workflow_steps\/5a614d4a-7de5-41ba-9a92-349d38b46f3b",
            "sourceStep": "\/api\/3\/workflow_steps\/4762ed22-ef55-45e0-bc73-665c18942eb0",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "717d581c-c3fb-43cf-8383-2712e825c829"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get Input Confirmation -> Copy of No Oprations",
            "targetStep": "\/api\/3\/workflow_steps\/925b3363-9514-481b-a6f2-ca6b2c978c89",
            "sourceStep": "\/api\/3\/workflow_steps\/ea015a19-e46e-47db-8f4b-0745e085ac6e",
            "label": "Review Required",
            "isExecuted": false,
            "group": null,
            "uuid": "18855fb7-2377-410f-bb2b-fd055fa02e25"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get Input Confirmation -> Postgresql Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/906fd8bb-8c4f-41f1-8957-f0af85e63a1c",
            "sourceStep": "\/api\/3\/workflow_steps\/ea015a19-e46e-47db-8f4b-0745e085ac6e",
            "label": "Details Are Correct",
            "isExecuted": false,
            "group": null,
            "uuid": "43624501-52b6-420d-9197-05e576ea96d3"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get System Configuration -> Check if Data is Present",
            "targetStep": "\/api\/3\/workflow_steps\/d2445dec-59c0-49db-becf-8ea878ae524f",
            "sourceStep": "\/api\/3\/workflow_steps\/f369a0d1-880a-4dfb-a947-17ff10356b8c",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "83f79bf4-0d0c-4a21-b709-4329ce54dd6f"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Postgresql Configuration -> Generate Report Code",
            "targetStep": "\/api\/3\/workflow_steps\/4762ed22-ef55-45e0-bc73-665c18942eb0",
            "sourceStep": "\/api\/3\/workflow_steps\/906fd8bb-8c4f-41f1-8957-f0af85e63a1c",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "cd0180a1-7cd9-4770-8eda-deb6b158319f"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Report as Attachment -> Attach Attachment to Task",
            "targetStep": "\/api\/3\/workflow_steps\/72479bb8-d469-4943-871a-fb9f8d033f1a",
            "sourceStep": "\/api\/3\/workflow_steps\/c6dcbe63-ddb1-4792-81f1-be31f0d3105b",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "0084bd29-4362-4b94-935b-bf3470d25098"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Create Task For Tracking Purposes1",
            "targetStep": "\/api\/3\/workflow_steps\/d90d974a-7ecb-4ace-925b-a20dc3c30122",
            "sourceStep": "\/api\/3\/workflow_steps\/74a7dcd0-6482-4ab9-a33f-6598255a3e32",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "2c11643a-00b7-4722-af7a-8c4fb79737b6"
        },
        {
            "@type": "WorkflowRoute",
            "name": "User Rejected the Configuration -> Record IRI for Reset",
            "targetStep": "\/api\/3\/workflow_steps\/041c1cb1-4cc5-490b-897d-841e1710771e",
            "sourceStep": "\/api\/3\/workflow_steps\/925b3363-9514-481b-a6f2-ca6b2c978c89",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "52a52250-9d73-4c28-a986-5d0c13ce2d2d"
        }
    ],
    "groups": [
        {
            "@type": "WorkflowGroup",
            "name": "Checking For Error and Create task to resolve error",
            "description": "There are two types of error that can occur, first due to PGSQL directory is not mounted and second one because of some command is not installed",
            "type": "block",
            "isCollapsed": false,
            "hasTriggerStep": false,
            "hideInLogs": false,
            "metadata": [],
            "reusable": false,
            "top": "40",
            "left": "980",
            "height": "174",
            "width": "679",
            "uuid": "d65f78fb-e9ae-410c-a966-28a280bc3fde",
            "recordTags": []
        },
        {
            "@type": "WorkflowGroup",
            "name": "Generate System Config Recomendation",
            "description": "",
            "type": "block",
            "isCollapsed": false,
            "hasTriggerStep": false,
            "hideInLogs": false,
            "metadata": [],
            "reusable": false,
            "top": "480",
            "left": "940",
            "height": "164",
            "width": "991",
            "uuid": "3d297f34-8c58-43ac-bc66-4de66a9d68ff",
            "recordTags": []
        },
        {
            "@type": "WorkflowGroup",
            "name": "Get System Details",
            "description": "This step uses python script to return you the system configuration",
            "type": "block",
            "isCollapsed": false,
            "hasTriggerStep": false,
            "hideInLogs": false,
            "metadata": [],
            "reusable": false,
            "top": "40",
            "left": "640",
            "height": "171",
            "width": "319",
            "uuid": "0877769d-2981-40f7-9a8e-4c477f0ee18f",
            "recordTags": []
        },
        {
            "@type": "WorkflowGroup",
            "name": "User Review",
            "description": "",
            "type": "block",
            "isCollapsed": false,
            "hasTriggerStep": false,
            "hideInLogs": false,
            "metadata": [],
            "reusable": false,
            "top": "220",
            "left": "980",
            "height": "167",
            "width": "688",
            "uuid": "d045e020-f8a5-4753-878a-2c10a4127511",
            "recordTags": []
        }
    ],
    "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
    "uuid": "7f5f86e0-56bd-47da-8b07-9dfc48e4d402",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": [
        "Refrenced",
        "Scenario",
        "System Configuration Recommendation"
    ]
}